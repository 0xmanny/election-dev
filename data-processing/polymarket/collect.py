import requests
import json
from pathlib import Path

markets = {
    "popular": "42699080635179861375280720242213672850141860123562672932351602811041149946128",
    "winner": "21742633143463906290569050155826241533067272736897614950488156847949938836455",
    "arizona": "64972410044896218211047269420581789917870192018252181026286744947120013986348",
    "florida": "98021166935117039411751630581502824091054448039251810280365647472625878604011",
    "georgia": "10874846387975190407444713373765853114527145924436779240006871443341352408992",
    "michigan": "105184348976114274990683066782141725521410345945023353024053078695238621958578",
    "minnesota": "92117185710429643911455104199091166119411848668357581614617019864951532204911",
    "nevada": "22811156622772246927379314532791131581149105511872861362055243423465705837015",
    "new-hampshire": "75196359692989187018411418870859031296447545562973355617507233505746713995861",
    "north-carlonia": "25474014705297439146444713942104010240322868585952420291288261803408266882449",
    "pennsylvania": "75951511934878014812323289513632732239356274541965522720897159608390126393735",
    "texas": "22954390469393761478435587094271162660864811978634802609696033004592606875337",
    "wisconsin": "8506489790932625039746959405160059426243994232527626857062384302531008283468",
}

current_dir = Path(__file__).parent

data_dir = current_dir / "raw"
data_dir.mkdir(exist_ok=True)

for market, market_id in markets.items():
    url = f"https://clob.polymarket.com/prices-history?market={market_id}&fidelity=1&startTs=1730782800"
    response = requests.get(url)
    response.raise_for_status()

    data = response.json()

    filename = data_dir / f"{market}.json"
    with open(filename, "w") as f:
        json.dump(data, f, indent=2)

    print(f"Successfully saved data for {market}")
